<!DOCTYPE html>
<html>
<head>
  <title>Blocks demo</title>
  <meta charset="utf-8">
  <style type="text/css">
    html, body {
      padding: 0;
      margin: 0;
      font-family: "Helvetica Neue", sans-serif;
      font-size: 24px;
      line-height: 1.5em;
    }

    .demo {
      padding: 0 32px;
      font-size: 13px;
    }

    .demo__header {
      margin: 16px 0 8px 0;
      font-size: 16px;
      font-weight: normal;
    }

    .demo__query-example {
      width: 100%; margin: auto;
    }
  </style>
  <link rel="stylesheet" type="text/css" href="dist/ring-lib.css">
  <link rel="icon" type="image/x-icon" href="site/favicon.ico">

  <script src="components/jquery/jquery.js"></script>
  <script src="components/requirejs/require.js"></script>
  <script src="bundles/ring.config.js"></script>

  <script>
    require([
      'jquery',
      'ring',
      'auth/auth',
      'header/header__hub-services',
      'header/header__userinfo',
      'json'],
      function($, ring) {
      window.ring = ring;

      var authData = window.location.host.indexOf('hub-dev') > -1 ?
      {
        redirectUri: "***REMOVED***",
        serverUri: "***REMOVED***/",
        refresh: true
      }
        :
      { serverUri: "http://localhost:8080",
        refresh: true
      };

      var o = ring();

      o('init', {
        header: {
          "type": "4x",
          "authLinks": {
            "login": {
              "label": "Log in",
              "event": "header:login"
            }
//            ,
//            "logout": {
//              "label": "Log out",
//              "event": "header:logout"
//            }
          }
        },
        menu: {
          "type": ["gradient", "4x"],
          "left": {
            "projects": {
              "toggle": {
                "items": [
                  {
                    "className": "test-class",
                    "label": "Issues",
                    "title": "Tilte attribute content",
                    "url": "/issues"
                  },
                  {
                    "label": "test hover",
                    "url": "/rest/agile",
                    "hover": "dropdown:hover",
                    "action": true
                  },
                  {
                    "label": "test click",
                    "url": "/rest/agile",
                    "click": {
                      name: "dropdown:click",
                      data: 'Clicked!'
                    },
                    "action": true
                  },
                  {
                    "label": "dependent",
                    "url": "/rest/agile",
                    "action": true
                  },
                  {
                    "label": "dependent",
                    "url": "/rest/agile",
                    "action": true
                  }
                ]
              },
              "active": 1,
              "url": "/projects",
              "event": {
                "name": "menu:test",
                "data": "projects"
              },
              "label": "Projects"
            },
            "agents": {
              "counter": {
                "color": "red",
                "label": 125
              },
              "label": "Agents",
              "url": "/rest/reports",
              "event": {
                "name": "menu:test",
                "data": "agents"
              },
              "toggle": {
                "items": [
                  {
                    "className": "test-class",
                    "label": "Issues",
                    "title": "Tilte attribute content",
                    "url": "/issues"
                  },
                  {
                    "className": "test-class",
                    "label": "Issues",
                    "title": "Tilte attribute content",
                    "url": "/issues"
                  },
                  {
                    "separator": true
                  },
                  {
                    "className": "test-class",
                    "label": "Issues",
                    "title": "Tilte attribute content",
                    "url": "/issues"
                  },
                  {
                    "className": "test-class",
                    "label": "Issues",
                    "title": "Tilte attribute content",
                    "url": "/issues"
                  },
                  {
                    "label": "Agile Board",
                    "url": "/rest/agile"
                  }
                ]
              }
            },
            "logo": {
              "order": 1,
              "image": "site/ring.png",
              "url": "/dashboard",
              "items": [
//                  {
//                    "className": "test-class",
//                    "label": "Issues",
//                    "title": "Tilte attribute content",
//                    "url": "/issues"
//                  },
                {
                  "label": "dependent",
                  "url": "/rest/agile",
                  "image": "site/ring.png",
                  "action": true
                },
                {
                  "label": "dependent",
                  "url": "/rest/agile",
                  "action": true
                },
                {
                  "label": "dependent",
                  "url": "/rest/agile",
                  "action": true
                },
                {
                  "label": "dependent",
                  "url": "/rest/agile",
                  "action": true
                }
              ]
            },
            "button": {
              "type": "button",
              "button": [{
                "label": "Add something",
                "className": "ring-btn_primary"
              }, {
                "className": "ring-btn_primary ring-btn_icon ring-btn__dropdown-icon",
                "type": "caret-down",
                "dropdown": {
                  "type": "prop-manager",
                  "items": [
                    {
                      "label": "Issues",
                      "url": "/issues",
                      "event": {
                        "name": "dropdown:test",
                        "data":{
                          "val":"prop"
                        }
                      }
                    },
                    {
                      "label": "Agile Board",
                      "url": "/rest/agile"
                    }
                  ]
                }
              }]
            }
          },
          "right": {
            "search": {
              "type": "search",
              "url": "/search"
            },
            "cog": {
              "items": [
                {
                  "label": "Issues",
                  "url": "/issues"
                },
                {
                  "label": "Agile Board",
                  "url": "/rest/agile"
                }
              ],
              "type": "cog",
              "url": "/prefs"
            },
            "help": {
              "type": "help",
              "url": "/help",
              "items": [
                {
                  "className": "test-class",
                  "label": "Issues",
                  "title": "Tilte attribute content",
                  "url": "/issues"
                },
                {
                  "label": "Agile Board",
                  "url": "/rest/agile"
                }
              ]
            }
          }
        },
        footer: {
          type: '4x',
          left: [
            [{url: 'http://www.jetbrains.com/teamcity/?fromServer', label: 'TeamCity'}, 'by JetBrains'],
            'Enterprise 8.0.2 EAP (build 27448)'
          ],
          center: [
            [{copyright: 2000, label: ' JetBrains'}, {middot: 1}, 'All rights reserved'],
            {url: 'http://teamcity.jetbrains.com/showAgreement.html', label: 'License agreement', title: 'READ ME!'}
          ],
          right: [
            {url: 'http://www.jetbrains.com/teamcity/feedback?source=footer&version=8.0.3%20(build%2027531)&build=27531&mode=ent', label: 'Feedback'}
          ]
        }
      });

        o.on('dropdown:test', function (e) {
          console.log(arguments);
          return false;
        });

      var auth = ring('auth');

      o.on('header:login', function() {
        auth('init', authData);
      });

      auth('init', $.extend({
        denyIA: true,
        refresh: true
      }, authData));

      o.on('menu:test', function(data) {
        ring('menu', 'setActive')(data);
        return false;
      });

      o.on('dropdown:hover', function() {
        ring('alerts').invoke('add', 'Ho-ho-hover', 'success', true, 10000);
      });

      o.on('dropdown:click', function(message) {
        ring('alerts').invoke('add', message, 'success', true, 10000);
      });

      // todo(igor.alexeenko): More impressive demo. Show all possibilities.
      ring('alerts').invoke('add', 'Alerts demo. Will hide in 10 secs.',
          'success', true, 10000);

      var query = ring('query-assist');
      query('init', {
        target: '.demo__query-example',
        CONTAINER_TOP_PADDING:21,
        MIN_LEFT_PADDING:32,
        dataSource: query('remoteDataSource', {
          url: 'api/rest/users/queryAssist?caret=#{caret}&fields=query,caret,suggestions#{styleRanges}&query=#{query}'
        })
      });

      query.on('apply', function() {
        ring('alerts', 'add')('Query submitted','success', 10000);
      });

      ring('shortcuts')('bind', {
        key: 'space',
        handler: function() {
          ring('alerts', 'add')('Shortcuts!','success', 10000);
        }
      });
    });
  </script>
</head>
<body>

<div class="demo">
  <h2 class="demo__header">Docs</h2>

  <div><a class="ring-link" href="dist/docs/API.html">View API documentation</a></div>
  <div><a class="ring-link" href="dist/styleguide/">CSS Styleguide</a></div>
  <div class="demo__query-example"></div>
</div>

</body>
</html>
