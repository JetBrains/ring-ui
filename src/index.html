<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>ring UI</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
<h1>React && WebPack</h1>

<div class="example">
  <header>Query Assist:</header>

  <section>
    <div id="query-assist">
    </div>
  </section>
</div>

<hr/>

<div class="example">
  <header>List:</header>

  <section>
    <div id="list">
    </div>
  </section>
</div>

<hr/>

<div class="example">
  <header>Progress Bar:</header>

  <section>
    <div id="progress-bar">
    </div>
  </section>
</div>

<hr/>

<div class="example">
  <header>Checkbox:</header>

  <section>
    <div id="checkbox">
    </div>
  </section>
</div>

<div class="example">
  <header>Textarea:</header>

  <section>
    <div id="textarea">
    </div>
  </section>
</div>

<div class="example dropdownExample">
  <section>
    <div id="dropdown">Dropdown</div>
  </section>
</div>

<div class="example">
  <header>Input:</header>

  <section>
    <div id="input">
    </div>
  </section>
</div>

<div class="example">
  <header>Button:</header>

  <section>
    <div id="button">
    </div>
  </section>
</div>

<div class="example">
  <header>Loader:</header>

  <section>
    <div id="loader">
    </div>

    <div>
      Inline Loader:
      <span id="loader-inline">
      </span>
    </div>
  </section>
</div>

<div class="example">
  <header>Diff</header>

  <section>
    Default(Single-pane):
    <div id="diff-default">
    </div>

    Double-pane:

    <!--attribute style - Not so good but simple-->
    <div id="diff-double-pane" style="height: 300px">
    </div>
    <hr/>

    Plain:
    <div id="diff-plain">
    </div>
  </section>
</div>

<div class="example">
  <header>Popup Menu</header>

  <section>
    Popup Menu:
    <div id="popup">Here I am!</div>

  </section>
</div>

<div class="example">
  <header>Footer</header>

  <section>
    Footer:
    <div id="footer"></div>

  </section>
</div>

<script type="text/javascript" src="jQuery.js" charset="utf-8"></script>
<script type="text/javascript" src="ring.js" charset="utf-8"></script>
<script>
  (function () {
    var value = 0,
      timeout = 500,
      progressBar = React.renderComponent(ring.ProgressBar({
          value: value
        }), document.getElementById('progress-bar'));

    setTimeout(function foo() {
      var _timeout = timeout;
      value += 0.1;
      if (value > 1) {
          value = 0;
          _timeout *= 2;
      }

      progressBar.setProps({ value: value });

      setTimeout(foo, _timeout);
    }, timeout);
  })();

  var auth = new ring.Auth({
    serverUri: '***REMOVED***/',
    redirect_uri: 'http://localhost:8080/'
  });
  auth.init().then(function() {
    React.renderComponent(
      ring.QueryAssist({
        query: 'test',
        placeholder: 'placeholder',
        onApply: console.log.bind(console),
        hint: 'lol',
        dataSource: function (props) {
          jQuery.extend(props, {
            fields: 'query,caret,suggestions,styleRanges'
          });

          return auth.requestToken().then(function (token) {
            return auth.getSecure('api/rest/users/queryAssist', token, props);
          });
        }
      }),
      document.getElementById('query-assist'));
  });

  React.renderComponent(
    ring.List({
      data: [
        {'label': 'One', 'type': ring.PopupMenu.Type.ITEM},
        {'label': 'Two', 'type': ring.PopupMenu.Type.ITEM},
        {'label': 'Three', 'type': ring.PopupMenu.Type.ITEM},
        {'label': 'Four', 'type': ring.PopupMenu.Type.ITEM},
        {'label': 'Five', 'type': ring.PopupMenu.Type.ITEM}
      ],
      shortcuts: true,
      onSelect: console.log.bind(console) // TODO Use alert here
    }),
    document.getElementById('list'));

  React.renderComponent(
    ring.Checkbox(),
    document.getElementById('checkbox'));

  React.renderComponent(
    ring.Textarea(),
    document.getElementById('textarea'));

  React.renderComponent(
    ring.Input(),
    document.getElementById('input'));

  React.renderComponent(
    ring.Button(null, 'Button'),
    document.getElementById('button'));

  React.renderComponent(
    ring.Loader(),
    document.getElementById('loader'));
  React.renderComponent(
    ring.Loader({
      modifier: ring.Loader.Modifier.INLINE
    }),
    document.getElementById('loader-inline'));

  React.renderComponent(
    ring.Diff({
      originalContent: 'original',
      modifiedContent: 'modified',
      diff: [
        {
          newLines: 1,
          oldLines: 1,
          type: 'modified'
        }
      ]
    }),
    document.getElementById('diff-default'));

  React.renderComponent(
    ring.Diff({
      mode: ring.Diff.Mode.DOUBLE_PANE,
      originalContent: 'Zoo\nFrfrfr\n',
      modifiedContent: 'Zoo\n',
      diff: [
        {
          "lines": 1,
          "type": "unchanged"
        },
        {
          "newLines": 0,
          "oldLines": 1,
          "type": "modified"
        }
      ]
    }),
    document.getElementById('diff-double-pane'));

  React.renderComponent(
    ring.Diff({
      mode: ring.Diff.Mode.PLAIN_FILE,
      originalContent: 'original',
      modifiedContent: 'modified',
      diff: [
        {
          newLines: 1,
          oldLines: 1,
          type: 'modified'
        }
      ]
    }),
    document.getElementById('diff-plain'));

  /**
   * @constructor
   * @extends {ReactComponent}
   * @mixes {ring.Popup.Mixin}
   */
  var CustomPopup = React.createClass({
    mixins: [ring.Popup.Mixin],

    getInternalContent: function() {
      return 'Dropdown element as mixin.';
    }
  });

  ring.Popup.renderComponent(new CustomPopup({
    anchorElement: document.getElementById('dropdown'),
    corner: CustomPopup.Corner.TOP_LEFT,
    classNames: ['additional', 'class', 'names']
  }));


  /**
   * @constructor
   * @extends {ReactComponent}
   */
  var SomeElementToInsertIntoPopup = React.createClass({
    render: function() {
      return React.DOM.div(null, 'Some external elemenet rendered into Popup');
    }
  });

  ring.Popup.renderComponent(ring.Popup(null, SomeElementToInsertIntoPopup(null)));

  var popupMenu = ring.PopupMenu.renderComponent(ring.PopupMenu({
    anchorElement: document.getElementById('popup'),
    corner: CustomPopup.Corner.TOP_LEFT,
    classNames: ['additional', 'class', 'names']
  }, null));

  popupMenu.setProps({data: [
    {'label': 'One'},
    {'label': 'Two', 'href': 'http://www.jetbrains.com'},
    {'label': 'Three', 'type': ring.PopupMenu.Type.ITEM, 'href': 'http://www.jetbrains.com'},
    {'type': ring.PopupMenu.Type.SEPARATOR},
    {'label': 'Four', 'type': ring.PopupMenu.Type.MENU_LINK},
    {'label': 'Five', 'type': ring.PopupMenu.Type.MENU_LINK, 'href': 'http://www.jetbrains.com', 'className': 'test'}
  ]});

  react.renderComponent(
    ring.Footer({
      className: 'stuff',
      left: [
        [{url: 'http://www.jetbrains.com/teamcity/?fromServer', label: 'TeamCity'}, ' by JetBrains'],
        'Enterprise 8.0.2 EAP (build 27448)'
      ],
      center: [
        [{copyright: 2000, label: ' JetBrains'}, ' Â· All rights reserved'],
        {url: 'http://teamcity.jetbrains.com/showAgreement.html', label: 'License agreement', title: 'READ ME!'}
      ],
      right: [
        {url: 'http://www.jetbrains.com/teamcity/feedback?source=footer&version=8.0.3%20(build%2027531)&build=27531&mode=ent', label: 'Feedback'}
      ]
    }),
    document.getElementById('footer'));
</script>
</body>
</html>
